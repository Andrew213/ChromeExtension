function l(t){const s=n=>console.log(`[JobAgent] ${n}`),e={running:!1,idx:0,timerId:0,settings:{speed:3,responseLetter:""}},o=()=>{const c=1800-Number(e.settings.speed||3)*300;return Math.max(250,c)},i=n=>{e.running&&(e.timerId&&clearTimeout(e.timerId),e.timerId=setTimeout(r.tick,n))},r={start(n){typeof n.speed=="number"&&(e.settings.speed=n.speed),typeof n.responseLetter=="string"&&(e.settings.responseLetter=n.responseLetter),s(`START site=${t.site} speed=${e.settings.speed} letterLen=${e.settings.responseLetter?.length}`),!e.running&&(e.running=!0,i(0))},tick(){if(!e.running)return;const n=t.tickImpl({idx:e.idx,settings:e.settings});if(e.idx=n.nextIdx,n.done){e.running=!1,s("DONE");return}i(o())}};return r}function d({idx:t,settings:s}){const e=document.querySelectorAll("[data-qa='vacancy-serp__vacancy']");if(console.log({Letter:s.responseLetter}),!e.length)return{nextIdx:t,done:!0};const o=e[t];if(!o)return{nextIdx:t,done:!0};o.scrollIntoView({block:"center"});const i=o.querySelector('[data-qa="serp-item__title"]')?.textContent?.trim();console.log(`[JobAgent] HH [${t+1}/${e.length}] ${i??"(no title)"}`);const r=o.querySelector('[data-qa="vacancy-serp__vacancy_response"]');return r?.href&&console.log(`[JobAgent] response href: ${r.href}`),{nextIdx:t+1}}console.log("[JobAgent] content loaded",location.href);chrome.runtime.onMessage.addListener(t=>{console.log("LISTEN",t),t?.type==="START_HH"&&(window.__jobAgent||(window.__jobAgent=l({site:"hh",tickImpl:d})),window.__jobAgent.start(t.settings))});
