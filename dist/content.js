const m=t=>{console.log("HH",t),chrome.runtime.sendMessage({type:"HELLO"})},g=t=>{console.log("SJ",t)},l="/assets/hh.png",p="/assets/sj.png",o={hh:"hh",sj:"sj",unknown:"unknown"},b=[{id:o.hh,name:"HeadHunter",match:t=>t==="hh.ru"||t.endsWith(".hh.ru"),img:l,subtitle:"Режим: hh.ru"},{id:o.sj,name:"SuperJob",match:t=>t==="superjob.ru"||t.endsWith(".superjob.ru"),img:p,subtitle:"Режим: superjob.ru"}];function w(t){return t=(t||"").toLowerCase().trim(),t.startsWith("www.")?t.slice(4):t}function u(t){const e=w(t);return b.find(c=>c.match&&c.match(e))||{id:o.unknown,name:"Unknown",img:"images/unknown.png",subtitle:"Сайт не поддержан"}}async function a(){const[t]=await chrome.tabs.query({active:!0,currentWindow:!0}),e=t?.url||"";let s="";try{s=e?new URL(e).host:""}catch{s=""}return s}const n=t=>document.getElementById(t),i=n("speedRange"),f=n("speedBadge"),S=n("startBtn"),y=n("stopBtn"),B=n("testBtn"),k=n("refreshBtn"),d={speed:Number(i.value)};S.onclick=async()=>{const t=await a(),e=u(t);if(e.id!==o.unknown){let s;e.id===o.hh&&(s=m),e.id===o.sj&&(s=g),chrome.tabs.query({active:!0,currentWindow:!0},async c=>{const[r]=c;r.id&&chrome.scripting.executeScript({target:{tabId:r.id},func:s,args:[d]})})}};y.onclick=()=>chrome.runtime.sendMessage({type:"STOP"});B.onclick=()=>chrome.runtime.sendMessage({type:"RUN_TEST_STEP"});k.onclick=h;i.addEventListener("input",()=>{const t=i.value;f.textContent=t,d.speed=Number(t)});async function h(){const t=await a(),e=u(t);n("siteName").textContent=e.name,n("hostText").textContent=t||"—",n("siteSubtitle").textContent=e.subtitle,n("siteImage").src=chrome.runtime.getURL(e.img),n("siteImage").title=e.id}h();chrome.runtime.onMessage.addListener((t,e,s)=>{console.log({message:t})});
